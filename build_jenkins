#!/bin/bash
set -e

#Butterfly root directory
cd "$(dirname "$0")"

make clean || true
git submodule sync
git submodule update --init
./configure CC=clang --with-examples --with-benchmarks --dpdk-conf x86_64-native-linuxapp-clang
./run_tests.sh
pkill -15 -f qemu | true
pkill -15 -f vhost | true

echo "Build result is OK"
exit 0
